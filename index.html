<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Descartes</title>
</head>
<body>
    <h2>Formulario de Registro</h2>
    <form id="productoForm">
        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha" name="fecha" required><br>
        
        <label for="turno">Turno:</label>
        <select id="turno" name="turno" required>
            <option value="">Seleccione turno</option>
            <option value="DIA">DÍA</option>
            <option value="NOCHE">NOCHE</option>
        </select><br>
        
        <label for="codigoProducto">Código de Producto:</label>
        <input type="text" id="codigoProducto" name="codigoProducto" required><br>
        
        <label for="numeroOrden">Número de Orden:</label>
        <input type="text" id="numeroOrden" name="numeroOrden" required><br>
        
        <label for="tolerado">Tolerado:</label>
        <input type="number" id="tolerado" name="tolerado" required min="0"><br>
        
        <label for="descarteTotal">Descarte Total:</label>
        <input type="number" id="descarteTotal" name="descarteTotal" required min="0"><br>
        
        <label for="observacion">Observación:</label>
        <input type="text" id="observacion" name="observacion"><br>
        
        <label for="vistoBueno">Visto Bueno:</label>
        <input type="text" id="vistoBueno" name="vistoBueno"><br>
        
        <button type="submit">Enviar</button>
    </form>

    <div id="mensaje"></div>

    <script>
        document.getElementById('productoForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const formData = {
                fecha: document.getElementById('fecha').value,
                turno: document.getElementById('turno').value,
                codigoProducto: document.getElementById('codigoProducto').value,
                numeroOrden: document.getElementById('numeroOrden').value,
                tolerado: document.getElementById('tolerado').value,
                descarteTotal: document.getElementById('descarteTotal').value,
                observacion: document.getElementById('observacion').value,
                vistoBueno: document.getElementById('vistoBueno').value
            };

            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbzq3KRiqoOx5acKUmUnB0zImrxYzBVVxzS-pkDyZm4YZmpkGhHP4qtE0AlOpFau7DzRsg/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                document.getElementById('mensaje').textContent = 'Datos enviados correctamente';
                document.getElementById('productoForm').reset();
                
            } catch (error) {
                document.getElementById('mensaje').textContent = 'Error al enviar los datos: ' + error.message;
                console.error('Error:', error);
            }
        });
    </script>
</body>
</html>
